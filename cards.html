<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="img/card.ico" type="image/x-icon">
    <link rel="shortcut icon" href="img/card.ico" type="image/x-icon">
    <title>抽籤與點名系統</title>
    <style>
        #loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #0d0d0d; 
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: #fff;
            font-size: 16px;
            z-index: 9999;
        }
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #ccc;
            border-top-color: #ffb366;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 10px;
        }
        body {
            margin: 0;
            padding: 0;
            font-family: 'YuPearl', Arial, sans-serif;
            min-height: 100vh;
            height: 100%;
            width: 100%;
            overflow: auto;
            background-color: #0d0d0d; 
        }
        #header-container {
            display: flex; 
            justify-content: center; 
            align-items: center; 
            padding: 10px; 
            gap: 10px;
        }
        #video-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -2;
        }
        #overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            z-index: -1;
        }
        h1 {
            margin: 0;
            color: #ffffff;
            font-size: 18px;
        }
        #buttons-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
        }
        .button {
            font-family: 'NaniFont-Regular', Arial, sans-serif !important;
            padding: 10px 20px;
            font-size: 18px;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            cursor: pointer;
            box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.3);
        }
        #shuffle-btn, #call-btn {
            font-weight: bold;
            background-color: #00505d;
        }
        #shuffle-btn:hover, #call-btn:hover {
            background-color: #006475;
        }
        #clear-btn {
            font-weight: bold;
            background-color: #ce452e;
        }
        #clear-btn:hover {
            background-color: #eb664f;
        }
        textarea {
            display: block;
            width: 90%;
            max-width: 550px;
            margin: 10px auto;
            height: 150px;
            max-height: 300px; 
            background-color: rgba(227, 227, 227, 0.75);
            color: #000;
            border: 1px solid #000;
            border-radius: 3px;
            padding: 10px;
            font-size: 16px;
            box-shadow: inset 0px 3px 5px rgba(0, 0, 0, 0.2);
            resize: none;
            overflow-y: auto;
        }
        #input-area::placeholder {
            color: #535353;
        }
        .example-container {
            max-width: 550px;
            width: 90%; 
            margin: 20px auto; 
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.7);
            background-color: rgba(43, 83, 83, 0.7); 
            display: flex;
            flex-direction: column; 
            align-items: flex-start;
            overflow: hidden; 
            gap: 10px;
        }
        #example-options {
            display: none;
            flex-wrap: wrap; 
            gap: 8px; 
            padding: 10px;
            width: 100%; 
            max-height: 40vh; 
            overflow-y: auto; 
            overflow-x: hidden; 
            border-radius: 8px;
            background-color: rgba(0, 0, 0, 0.4);
            box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.5);
        }
        #example-options.visible {
            visibility: visible;
            opacity: 1;
        }
        .example-option {
            font-family: 'NaniFont-Regular', Arial, sans-serif !important;
            font-size: 16px;
            text-align: center;
            background-color: #176367;
            color: #fff;
            padding: 8px 10px;
            border-radius: 4px;
            cursor: pointer;
            box-shadow: 0px 3px 5px rgba(0, 0, 0, 0.3);
        }
        .example-option:hover {
            background-color: #277377;
        }
        .example-container, #example-options {
            writing-mode: unset;
            width: 90%;
        }
        #example-btn {
            background-color: #003d40; 
            color: #fff; 
            padding: 8px 14px; 
            font-size: 18px; 
            font-weight: bold; 
            border-radius: 6px; 
            cursor: pointer; 
            box-shadow: 0px 4px 5px rgba(0, 0, 0, 0.7);
            text-align: center; 
        }
        #example-btn:hover {
            background-color: #084548; 
        }      
        .card-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: none;
            max-width: 770px;
            min-height: 156.55px;
            max-height: 670px; 
            flex-wrap: wrap;
            justify-content: center;
            margin: 15px auto;
            padding: 10px;
            overflow-y: auto;
            overflow-x: hidden;
            background-color: rgba(20, 20, 20, 0.3);
            border-radius: 4px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(92, 125, 155, 0.4);
            z-index: 1;
        }
        .card {
            width: 93.75px;
            height: 156.25px;
            margin: 6px;
            position: relative;
            perspective: 1000px;
            cursor: pointer; 
            border: 1px solid rgba(0, 0, 0, 0.2)
            z-index: 2;
        }
        .card .inner {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            transform: rotateY(180deg);
        }
        .card.hidden .inner {
            transform: rotateY(0deg);
        }
        .card .back, .card .front {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 4px;
            backface-visibility: hidden;
        }
        .card .back {
            background-image: url('img/backcard.png');
            background-content: center;
            background-size: cover;
        }
        .card .front {
            background-color: #e4dbcf;
            color: #000;
            font-weight: bold;
            writing-mode: vertical-rl;
            text-orientation: upright;
            transform: rotateY(180deg);
        }
        .tarot-mode .card {
            width: 150px;   
            height: 250px;  
        }
        .tarot-mode .card.reversed .inner {
            transform: rotateY(180deg) rotate(180deg); /* 逆位卡片 */
        }
        .shuffle-card {
            width: 93.75px;
            height: 156.25px;
            margin: 6px;
            position: absolute;
            background-image: url('img/backcard.png');
            background-size: cover;
            border-radius: 4px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.2);
            z-index: 2;
        }
        .container {
            max-width: 800px; 
            width: 90%; 
            overflow-y: auto;
            overflow-x: hidden;
        }
        @font-face {
            font-family: 'NaniFont-Regular';
            src: url('ttf/NaniFont-Regular.woff') format('woff');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'Sangyo';
            src: url('ttf/sangyo.woff2') format('woff2');
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'YuPearl';
            src: url('ttf/YuPearl-Regular.woff2') format('woff2'), 
            font-weight: normal;
            font-style: normal;
        }
        @font-face {
            font-family: 'ThePeakFont';
            src: url('ttf/ThePeakFont.woff2') format('woff2'), 
            font-weight: normal;
            font-style: normal;
        }
        #description-box {
            font-family: 'ThePeakFont', Arial, sans-serif !important;
            display: none;
            max-width: 550px;
            margin: 20px auto;
            padding: 10px;
            background-color: rgba(31, 64, 97, 0.3);
            border-radius: 8px;
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.5);
            border: 2px solid rgba(92, 125, 155, 0.4);
            max-height: 210px;
            overflow-y: auto;
            color: #ffffff;
            font-size: 18px;
            text-align: left;
        }
        .dimmed {
            background-color: rgba(100, 100, 100, 0.1) !important;
            backdrop-filter: blur(4px); 
            -webkit-backdrop-filter: blur(2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5); 
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        .dimmed-container { 
            display: none;
            max-height: 70vh !important;
            overflow-y: auto !important;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            padding: 4px ; 
        }
        #time-display {
            display: inline-block;
            padding: 3px; 
            font-size: 13px; 
            color: #ffffff; 
            background-color: rgba(0, 0, 0, 0.5); 
            border-radius: 5px; 
            box-shadow: 0px 4px 6px rgba(0, 0, 0, 0.5); 
            text-align: center; 
            font-family: "Sangyo", sans-serif !important; 
        }
        textarea::-webkit-scrollbar,
        .dimmed-container::-webkit-scrollbar,
        .card-container::-webkit-scrollbar {
            width: 8px;
        }
        textarea::-webkit-scrollbar-track,
        .dimmed-container::-webkit-scrollbar-track,
        .card-container::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3); 
            border-radius: 10px; 
        }
        textarea::-webkit-scrollbar-thumb,
        .dimmed-container::-webkit-scrollbar-thumb,
        .card-container::-webkit-scrollbar-thumb {
            background: rgba(137, 198, 185, 0.8);
            border-radius: 10px; 
            border: 2px solid rgba(119, 136, 153, 0.5);
            cursor: pointer; 
        }
        textarea::-webkit-scrollbar-thumb:hover,
        .dimmed-container::-webkit-scrollbar-thumb:hover,
        .card-container::-webkit-scrollbar-thumb:hover {
            background: rgba(77, 160, 140, 0.9); 
        }
        textarea::-webkit-scrollbar-corner,
        .dimmed-container::-webkit-scrollbar-corner,
        .card-container::-webkit-scrollbar-corner {
            background: transparent;
        }
        .hoverable {
            transition: transform 0.2s;
        }
        .hoverable:hover {
            transform: translateY(-2px);
        }        
        #audio-control-container {
            position: fixed;
            bottom: 15px;
            left: 15px;
            display: flex;
            align-items: center;
            margin: 0;
            gap: 10px;
            z-index: 1000;
        }        
        #volume-slider {
            width: 120px;
            height: 6px; 
            cursor: pointer;
            appearance: none; 
            background: linear-gradient(to right, rgba(49, 97, 197, 0.4), rgba(19, 67, 167, 0.3));
            border-radius: 5px; 
            outline: none; 
            transition: all 0.2s ease;
        }
        #volume-slider::-webkit-slider-thumb {
            appearance: none; 
            width: 15px; 
            height: 15px;
            background: #4d80e6; 
            border: 2px solid #335292;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5); 
            cursor: pointer;
        }
        #volume-slider::-moz-range-thumb {
            width: 15px;
            height: 15px;
            background: #4d80e6;
            border: 2px solid #335292;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            cursor: pointer;
        }
        #volume-slider:hover {
            background: linear-gradient(to right, rgba(144, 169, 220, 0.4), rgba(19, 67, 167, 0.3));
        }
        #volume-slider:active::-webkit-slider-thumb {
            background: #546ea2;
            transform: scale(1.2); 
        }
        #bgm-button {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            border: none;
            background-color: rgba(79, 101, 121, 0.3);
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 0; 
            margin: 0; 
            line-height: 18px;
            box-shadow: 0 4px 6px rgba(0, 6, 8, 0.7);
            transition: all 0.2s ease;
        }
        #bgm-button:hover {
            background-color: rgba(92, 126, 158, 0.3);
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @media (max-width: 768px) {
            .container {
                width: 85% !important;
            }
            .card {
                width: 93.75px; 
                height: 156.25px;
                font-size: 14px;
            }
            .card-container {
                max-width: 90% !important;
                max-height: 500.75px !important; 
                padding: 8px !important;
            }
            #description-box {
                max-width: 90% !important;
            .example-option {
                left: 25% !important;
                font-size: 10px; 
                padding: 4px 4px;
            }
            #example-options {
                max-height: 30vh; 
            }
            #example-btn {
                padding: 8px 10px !important;
                font-size: 12px !important;
            }
            textarea {
                max-width: 90% ;
            }
            .example-container {
                max-height: 40vh;
                padding: 8px;
                gap: 3px;
                flex-direction: column; 
            }
            #mute-icon {
                font-size: 18px;
                color: #d16f6f;
                margin-right: 8px;
            }
        }
    </style>
</head>
<body>
    <div id="loading-screen">
    <div class="loading-spinner"></div>
    <p>資源載入中，請稍候...</p>
    </div>
    <div id="main-content" style="display: none;">
        <video id="video-background" autoplay muted loop playsinline>
            <source src="v/Wall.webm" type="video/webm">
            Your browser does not support the video tag.
        </video>
        <div id="overlay"></div>

        <div id="header-container">
            <h1>大倉酷抽籤與點名系統</h1>
            <div id="time-display"></div>
        </div>
    
        <div id="audio-control-container">
            <input id="volume-slider" type="range" min="0" max="1" step="0.01" value="0.5">
            <button id="bgm-button">♫</button>
        </div>

        <div id="buttons-container">
            <button id="shuffle-btn" class="button">洗牌抽籤</button>
            <button id="call-btn" class="button">啟動點名</button>
            <button id="clear-btn" class="button">清除資料</button>
        </div>

        <textarea id="input-area" placeholder="請輸入項目，每行一個項目"></textarea>

        <div class="example-container">
            <button id="example-btn" class="button">範例選擇</button>
            <div id="example-options" class="horizontal-options">
                <div class="example-option" data-value="1\n2\n3\n4\n5">數字</div>
                <div class="example-option" data-value="經國\n大竹\n南崁\n南昌\n中壢\n環東\n桃鶯\n正光\n龜山\n八德\n龍潭\n楊梅\n竹北\n公益\n福科\n崇德\n三峽\n板橋\n新泰\n龍安\n西門\n永和">分店點名</div>
                <div class="example-option" data-value="一月\n二月\n三月\n四月\n五月\n六月\n七月\n八月\n九月\n十月\n十一月\n十二月">月份</div>
                <div class="example-option" data-value="大吉\n中吉\n小吉\n末吉\n凶\n大凶">御神籤</div>
                <div class="example-option" data-value="愚者\n魔術師\n女祭司\n皇后\n皇帝\n教皇\n戀人\n戰車\n力量\n隱者\n命運之輪\n正義\n倒吊人\n死神\n節制\n惡魔\n天雷\n星星\n月亮\n太陽\n審判\n世界\n權杖1\n權杖2\n權杖3\n權杖4\n權杖5\n權杖6\n權杖7\n權杖8\n權杖9\n權杖10\n權杖侍者\n權杖騎士\n權杖皇后\n權杖國王\n寶劍1\n寶劍2\n寶劍3\n寶劍4\n寶劍5\n寶劍6\n寶劍7\n寶劍8\n寶劍9\n寶劍10\n寶劍侍者\n寶劍騎士\n寶劍皇后\n寶劍國王\n錢幣1\n錢幣2\n錢幣3\n錢幣4\n錢幣5\n錢幣6\n錢幣7\n錢幣8\n錢幣9\n錢幣10\n錢幣侍者\n錢幣騎士\n錢幣皇后\n錢幣國王\n聖杯1\n聖杯2\n聖杯3\n聖杯4\n聖杯5\n聖杯6\n聖杯7\n聖杯8\n聖杯9\n聖杯10\n聖杯侍者\n聖杯騎士\n聖杯皇后\n聖杯國王">塔羅牌</div>
                <div class="example-option" data-value="A♠️\nK♠️\nQ♠️\nJ♠️\n10s\n9♠️\n8♠️\n7♠️\n6♠️\n5♠️\n4♠️\n3♠️\n2♠️\nA♥️\nK♥️\nQ♥️\nJ♥️\n10h\n9♥️\n8♥️\n7♥️\n6♥️\n5♥️\n4♥️\n3♥️\n2♥️\nA♦️\nK♦️\nQ♦️\nJ♦️\n10d\n9♦️\n8♦️\n7♦️\n6♦️\n5♦️\n4♦️\n3♦️\n2♦️\nA♣️\nK♣️\nQ♣️\nJ♣️\n10c\n9♣️\n8♣️\n7♣️\n6♣️\n5♣️\n4♣️\n3♣️\n2♣️\n鬼王\n小鬼">poker(54)</div>
                <div class="example-option" data-value="A♠️\nK♠️\nQ♠️\nJ♠️\n10s\n9♠️\n8♠️\n7♠️\n6♠️\nA♥️\nK♥️\nQ♥️\nJ♥️\n10h\n9♥️\n8♥️\n7♥️\n6♥️\nA♦️\nK♦️\nQ♦️\nJ♦️\n10d\n9♦️\n8♦️\n7♦️\nA♣️\nK♣️\nQ♣️\nJ♣️\n10c\n9♣️\n8♣️\n7♣️\n鬼王\n小鬼">poker(36)</div>
                <div class="example-option" data-value="A♥️\nK♥️\nQ♥️\nJ♥️\n10h\n9♥️\n8♥️\n7♥️\n6♥️\nA♦️\nK♦️\nQ♦️\nJ♦️\n10d\n9♦️\n8♦️\n7♦️\n鬼王">紅(18)</div>
                <div class="example-option" data-value="A♠️\nK♠️\nQ♠️\nJ♠️\n10s\n9♠️\n8♠️\n7♠️\n6♠️\nA♣️\nK♣️\nQ♣️\nJ♣️\n10c\n9♣️\n8♣️\n7♣️\n小鬼">黑(18)</div>
            </div>
        </div>

        <div id="shuffle-animation-container"></div>
        <div id="card-container" class="card-container"></div>
        <div id="description-box"></div>
        <audio id="clickSound" src="m/click.mp3"></audio>
        <audio id="scoreSound" src="m/Sou.mp3"></audio>

    </div>
    <script>
    const clickSound = document.getElementById('clickSound');
    const scoreSound = document.getElementById('scoreSound');

    function playScoreSound() {
      scoreSound.currentTime = 0; // 重置播放位置
      scoreSound.play().catch(error => console.warn('範例按鈕音效失敗:', error));
    }
    document.querySelectorAll('.example-option').forEach(button => {
        button.addEventListener('click', playScoreSound);
    });

    const images = [
    'img/t0.png', 'img/t1.png', 'img/t2.png', 'img/t3.png', 'img/t4.png',
    'img/t5.png', 'img/t6.png', 'img/t7.png', 'img/t8.png', 'img/t9.png',
    'img/t10.png', 'img/t11.png', 'img/t12.png', 'img/t13.png', 'img/t14.png',
    'img/t15.png', 'img/t16.png', 'img/t17.png', 'img/t18.png', 'img/t19.png',
    'img/t20.png', 'img/t21.png',

    'img/joker_small.png', 'img/joker_big.png',
    'img/3g.png', 'img/2g.png', 'img/1g.png', 'img/0g.png',
    'img/1s.png', 'img/2s.png', 'img/backcard.png',

    'img/W1.png', 'img/W2.png', 'img/W3.png', 'img/W4.png', 'img/W5.png',
    'img/W6.png', 'img/W7.png', 'img/W8.png', 'img/W9.png', 'img/W10.png',
    'img/W11.png', 'img/W12.png', 'img/W13.png', 'img/W14.png',

    'img/F1.png', 'img/F2.png', 'img/F3.png', 'img/F4.png', 'img/F5.png',
    'img/F6.png', 'img/F7.png', 'img/F8.png', 'img/F9.png', 'img/F10.png',
    'img/F11.png', 'img/F12.png', 'img/F13.png', 'img/F14.png',

    'img/S1.png', 'img/S2.png', 'img/S3.png', 'img/S4.png', 'img/S5.png',
    'img/S6.png', 'img/S7.png', 'img/S8.png', 'img/S9.png', 'img/S10.png',
    'img/S11.png', 'img/S12.png', 'img/S13.png', 'img/S14.png',

    'img/C1.png', 'img/C2.png', 'img/C3.png', 'img/C4.png', 'img/C5.png',
    'img/C6.png', 'img/C7.png', 'img/C8.png', 'img/C9.png', 'img/C10.png',
    'img/C11.png', 'img/C12.png', 'img/C13.png', 'img/C14.png'
    ];
let loadedCount = 0;
let totalResources = images.length + 1; 

// 檢查資源載入
function checkResourcesLoaded() {
    loadedCount++;
    console.log(`已載入資源數量: ${loadedCount}/${totalResources}`);
    if (loadedCount >= totalResources) {
        document.getElementById('loading-screen').style.display = 'none';
        document.getElementById('main-content').style.display = 'block';
    }
}

// 預載圖片
function preloadImages() {
    totalResources += images.length;
    images.forEach(src => {
        const img = new Image();
        img.src = src;
        img.onload = checkResourcesLoaded;
        img.onerror = () => {
            console.error(`圖片載入失敗: ${src}`);
            checkResourcesLoaded();
        };
    });
}

// 預載影片
function preloadVideo() {
    const video = document.getElementById('video-background');
    if (!video) {
        console.error('video-background 元素未找到！');
        checkResourcesLoaded();
        return;
    }
    totalResources++; // 增加影片資源
    video.addEventListener('loadeddata', checkResourcesLoaded);
    video.addEventListener('error', () => {
        console.error('影片載入失敗！');
        checkResourcesLoaded();
    });
}

// 確保 DOM 和資源載入完成
window.addEventListener('load', () => {
    preloadImages();
    preloadVideo();
});

// 設置5 秒超時保護
setTimeout(() => {
    console.warn('資源載入超時，自動切換到主畫面！');
    document.getElementById('loading-screen').style.display = 'none';
    document.getElementById('main-content').style.display = 'block';
}, 3000);

        const inputArea = document.getElementById('input-area');
        const shuffleAnimationContainer = document.getElementById('shuffle-animation-container');
        const cardContainer = document.getElementById('card-container');
        const flipSound = new Audio('m/card.mp3');
        const shuffleSound = new Audio('m/shuffle.mp3');
        const shuffleBtn = document.getElementById('shuffle-btn');
        const callBtn = document.getElementById('call-btn');
        const clearBtn = document.getElementById('clear-btn');
        const exampleBtn = document.getElementById('example-btn');
        const exampleOptions = document.getElementById('example-options');
        const exampleContainer = document.querySelector('.example-container'); 
        const descriptionBox = document.getElementById('description-box');

        //範例功能列
        exampleBtn.addEventListener('click', () => {
            clickSound.currentTime = 0; // 重置播放位置
            clickSound.play().catch(error => console.warn('按鈕音效失敗:', error));
            if (exampleOptions.style.display === 'none' || exampleOptions.style.display === '') {
                exampleOptions.style.display = 'flex';
            } else {
                exampleOptions.style.display = 'none';
            }
        });
        document.querySelectorAll('.example-option').forEach(option => {
            option.addEventListener('click', () => {
                inputArea.value = option.dataset.value.replace(/\\n/g, '\n');
            });
        });
        // 洗牌動畫效果
        function shuffleAnimation(items) {
            const shuffleContainer = document.createElement('div');
            shuffleContainer.id = 'shuffle-animation-container';
            shuffleContainer.style.position = 'absolute';
            shuffleContainer.style.top = '50%'; 
            shuffleContainer.style.left = '0';
            shuffleContainer.style.width = '100%';
            shuffleContainer.style.height = '150px';
            shuffleContainer.style.transform = 'translateY(-50%)';
            shuffleContainer.style.display = 'flex';
            shuffleContainer.style.justifyContent = 'center';
            shuffleContainer.style.alignItems = 'center';
            shuffleContainer.style.zIndex = '10';
            shuffleContainer.style.overflow = 'hidden';
            shuffleContainer.style.pointerEvents = 'none';
            // 插入到 cardContainer 內部
            const cardContainer = document.getElementById('card-container');
            cardContainer.appendChild(shuffleContainer);
            // 建立卡片動畫
            const shuffleCards = items.map((_, index) => {
                const card = document.createElement('div');
                card.className = 'shuffle-card';
                card.style.width = '93.75px';
                card.style.height = '156.25px';
                card.style.margin = '5px';
                card.style.position = 'absolute';
                card.style.backgroundImage = "url('img/backcard.png')";
                card.style.backgroundSize = 'cover';
                card.style.borderRadius = '4px';
                // 初始位置設置在 X 軸
                card.style.left = '50%';
                card.style.transform = 'translateX(-50%)';
                shuffleContainer.appendChild(card);
                return card;
            });
            // 播放動畫
            shuffleCards.forEach(card => {
                const duration = 1000;
                const direction = Math.random() < 0.5 ? -1 : 1; 
                const translateX = (Math.random() * 150 + 50) * direction; // 移動範圍 ±50px 到 ±200px
                card.animate([
                    { transform: 'translateX(-50%)' },
                    { transform: `translateX(calc(-50% + ${translateX}px))` },
                    { transform: 'translateX(-50%)' }
                ], {
                    duration: duration * 0.55,
                    iterations: 2 // 三次往返
                });
            });
             // 清理動畫
            Promise.all(
                shuffleCards.map(card => card.getAnimations()[0].finished)
            ).then(() => {
                shuffleContainer.remove(); // 移除動畫容器，確保可重複執行
            });
        }
        // 洗牌抽籤系統
        shuffleBtn.addEventListener('click', () => {
            clickSound.currentTime = 0; // 重置播放位置
            clickSound.play().catch(error => console.warn('按鈕音效失敗:', error));
            const items = inputArea.value.trim().split('\n').filter(Boolean);
            if (items.length < 2) {
                alert('請至少輸入兩個項目進行抽籤！');
                return;
            }
                inputArea.style.display = 'none';
                exampleContainer.style.display = 'none'; 
                cardContainer.style.display = 'flex';
                cardContainer.innerHTML = '';

                if (items.includes('命運之輪')) {
                showTarotReading(items);
                return;
                }

            requestAnimationFrame(() => {
                shuffleAnimation(items);
                shuffleSound.currentTime = 0; 
                shuffleSound.play(); 
            });
            setTimeout(() => {
                items.sort(() => Math.random() - 0.5);
                items.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    const content = generateCardContent(item);
                     card.innerHTML = `<div class="inner">
                                        <div class="back"></div>
                                        <div class="front">${content}</div>
                                       </div>`;
                    card.classList.add('hidden');
                    card.addEventListener('click', () => {
                        card.classList.toggle('hidden');
                        flipSound.currentTime = 0; 
                        flipSound.play(); 
                    });
                    cardContainer.appendChild(card);
                });
            }, 1010); // 等動畫結束再生成卡片
        });
        //塔羅牌模式
        function showTarotReading(items) {
            // 顯示解說框
            descriptionBox.style.display = 'block';
            descriptionBox.innerHTML = '<b>請翻開您的命運之牌...</b><br>本系統採時間之流的三張抽牌方式，<br>可依序得出「過去、現在、未來」或「原因、結果、建議」<br>得出問題能夠處理的對策方向，<br>問問題的方式請以自己「想怎麼做？」的想法，<br>搭配「該如何做才能加以實現」這樣的形式對策，<br>才能得到較明確而詳細的回饋。';
            cardContainer.classList.add('tarot-mode'); //塔羅模式開啟
            requestAnimationFrame(() => {
                shuffleAnimation(items);
                shuffleSound.currentTime = 0; 
                shuffleSound.play(); 
            });
            setTimeout(() => {
                // 隨機抽取三張牌
                const selectedCards = [];
                while (selectedCards.length < 3) {
                    const randomIndex = Math.floor(Math.random() * items.length);
                    if (!selectedCards.includes(items[randomIndex])) {
                            selectedCards.push(items[randomIndex]);
                    }
                }
                const cardContainer = document.getElementById('card-container');
                cardContainer.innerHTML = '';
                selectedCards.forEach(item => {
                    const isReversed = Math.random() < 0.5; //逆位率50%
                    const card = document.createElement('div');
                    card.className = 'card';
                    if (isReversed) {
                       card.classList.add('reversed');
                    }
                    const content = generateCardContent(item);
                    card.innerHTML = `<div class="inner">
                                        <div class="back"></div>
                                        <div class="front">${content}</div>
                                      </div>`;
                    card.classList.add('hidden');
                    card.addEventListener('click', () => {
                        card.classList.toggle('hidden');
                        flipSound.currentTime = 0; 
                        flipSound.play(); 
                        descriptionBox.innerHTML = getCardDescription(item);
                    });
                    cardContainer.appendChild(card);
                });
            }, 1010);
        }
    // **牌義解釋邏輯**
    function getCardDescription(item) {
            const descriptions = {
            '愚者': '愚者 ——<br>冒險的開始、無限可能與自由精神。<br>正面(正位)： 天真與自發性、迎接新機遇與變化。<br>負面(逆位)： 衝動與缺乏計劃、過於樂觀導致風險。<br>延伸： 鼓勵勇敢追求夢想，同時注意風險評估與準備。',
            '魔術師': '魔術師 ——<br>創造與掌控現實的能力，將想法化為行動。<br>正面(正位)： 自信與技巧、資源整合與行動力。<br>負面(逆位)： 欺騙與誤導、缺乏真誠與操控他人。<br>延伸： 建議充分利用資源，將構想付諸實現，但要保持誠信。',
            '女祭司': '女祭司 ——<br>內在智慧與直覺，探索隱藏的真相與知識。<br>正面(正位)： 靈性洞察、內在指引與神秘感。<br>負面(逆位)： 秘密與壓抑、缺乏行動與消極態度。<br>延伸： 鼓勵傾聽內心聲音，運用直覺並保持耐心等待答案浮現。',
            '皇后': '皇后 ——<br>豐盛與滋養，代表愛與創造力的象徵。<br>正面(正位)： 豐收與母性關懷、創意與生長。<br>負面(逆位)： 過度保護、懶散與缺乏進取心。<br>延伸： 鼓勵培養創意與情感豐富，同時注意自我照顧與平衡。',
            '皇帝': '皇帝 ——<br>權威與結構，掌控與保護的象徵。<br>正面(正位)： 穩固與實踐、領導力與責任感。<br>負面(逆位)： 專制與控制慾過強、缺乏靈活性。<br>延伸： 建議建立穩固基礎，但同時保持靈活與開放態度。',
            '教皇': '教皇 ——<br>信仰與傳統，靈性指導與學習的象徵。<br>正面(正位)： 指導與教育、道德與靈性發展。<br>負面(逆位)： 過度教條、缺乏創新與受限思維。<br>延伸： 鼓勵尋求智慧與精神成長，同時保持彈性與批判思維。',
            '戀人': '戀人 ——<br>愛情與選擇，情感與靈魂連結的象徵。<br>正面(正位)： 真愛與和諧、靈魂伴侶與平衡。<br>負面(逆位)： 不忠與迷失、優柔寡斷與分裂。<br>延伸： 鼓勵溝通與理解，在情感與選擇中保持真誠與平衡。',
            '戰車': '戰車 ——<br>勝利與意志力，掌控方向與前進動力。<br>正面(正位)： 決心與勝利、克服挑戰與進步。<br>負面(逆位)： 固執與控制欲、缺乏彈性與衝突。<br>延伸： 鼓勵集中目標與行動力，但避免強硬態度導致阻礙。',
            '力量': '力量 ——<br>勇氣與內在力量，克服挑戰與控制情緒。<br>正面(正位)： 自信與耐心、克服恐懼與挑戰。<br>負面(逆位)： 缺乏自信、衝動與情緒失控。<br>延伸： 鼓勵相信自我力量，同時練習耐心與自我控制。',
            '隱者': '隱者 ——<br>內在探索與智慧，靜思與尋求真理。<br>正面(正位)： 靜心與反思、智慧與指引。<br>負面(逆位)： 孤立與逃避、缺乏連結與行動力。<br>延伸： 鼓勵內在成長與自省，但需避免過度孤立。',
            '命運之輪': '命運之輪 ——<br>循環與改變，命運的轉變與機遇。<br>正面(正位)： 好運與新機會、正向變化與進展。<br>負面(逆位)： 無法控制的變動、缺乏穩定感與恐懼失控。<br>延伸： 提醒接受變化，順應命運流動並靈活應對挑戰。',
            '正義': '正義 ——<br>平衡與公平，客觀判斷與道德觀念。<br>正面(正位)： 公平與誠實、正義與責任感。<br>負面(逆位)：偏見與不公正、過度批判與固執己見。<br>延伸： 鼓勵維護公正與誠信，同時開放接受不同觀點。',
            '倒吊人': '倒吊人 ——<br>犧牲與靜止，逆境中的啟發與轉變。<br>正面(正位)： 靜思與啟示、轉換觀點與內在成長。<br>負面(逆位)： 遲滯與逃避、被迫放棄與犧牲自我。<br>延伸： 建議重新評估現狀，尋求內在智慧並接納新視角。',
            '死神': '死神 ——<br>結束與重生，舊有模式的結束與新開始。<br>正面(正位)： 轉變與重生、釋放舊事物並迎接新機會。<br>負面(逆位)： 抗拒改變、停滯與過去糾纏不清。<br>延伸： 鼓勵放下過去，接受新開始並擁抱變革。',
            '節制': '節制 ——<br>平衡與和諧，適應與融合不同元素。<br>正面(正位)： 和諧與節制、適應與耐心。<br>負面(逆位)： 缺乏控制、過度行為與焦慮不安。<br>延伸： 建議保持平衡與耐心，穩健應對挑戰與變化。',
            '惡魔': '惡魔 ——<br>誘惑與束縛，物質與內心衝突的象徵。<br>正面(正位)： 魅力與吸引力、探索內在慾望與需求。<br>負面(逆位)： 成癮與依賴、被束縛於負面情境。<br>延伸： 提醒覺察內心陰影並釋放束縛與控制。',
            '天雷': '天雷 ——<br>突如其來的改變，劇烈動盪與突破。<br>正面(正位)： 覺醒與釋放、舊有結構的崩解。<br>負面(逆位)： 震驚與混亂、失控與焦慮感。<br>延伸： 鼓勵適應快速變化，從危機中學習與重建。',
            '星星': '星星 ——<br>希望與靈感，重新建立信心與方向。<br>正面(正位)： 指引與靈感、希望與療癒。<br>負面(逆位)： 過度樂觀、缺乏現實感與脫離實際。<br>延伸： 鼓勵保持信念與正向態度，追求夢想與靈感。',
            '月亮': '月亮 ——<br>幻象與直覺，隱藏事物與不安情緒。<br>正面(正位)： 直覺與夢境、探索內心深處。<br>負面(逆位)： 幻想與混亂、欺騙與誤導。<br>延伸： 提醒辨識真相與錯覺，保持冷靜應對情緒波動。',
            '太陽': '太陽 ——<br>成功與快樂，光明與活力的象徵。<br>正面(正位)： 快樂與成功、自信與希望。<br>負面(逆位)： 過度樂觀與自負、忽視細節。<br>延伸： 鼓勵展現熱情與正能量，同時保持謙虛。',
            '審判': '審判 ——<br>重生與覺醒，面對過去或挑戰並開始新的階段。<br>正面(正位)： 覺醒與寬恕、改變與重生。<br>負面(逆位)： 害怕改變、抗拒成長與內疚感。<br>延伸： 鼓勵面對過去與未來，勇敢做出新決定。',
            '世界': '世界 ——<br>完成與圓滿，目標達成與整體成就。<br>正面(正位)： 成功與滿足、旅程的圓滿結束。<br>負面(逆位)： 未竟的目標、缺乏方向與滿足感。<br>延伸： 鼓勵珍惜成果並準備迎接新旅程。',
            '權杖1': '權杖1 ——<br>創新的開始、靈感爆發與動力湧現。<br>正面(正位)： 創造力與動力的開始、新機會與行動力。<br>負面(逆位)： 缺乏計劃、魯莽行動與焦躁不安。<br>延伸： 鼓勵踏出第一步，同時規劃行動策略以提高成功率。',
            '權杖2': '權杖2 ——<br>展望未來與策略規劃。<br>正面(正位)： 遠見與計劃、合作與探索未來。<br>負面(逆位)： 猶豫不決、缺乏行動力與目標不明。<br>延伸： 鼓勵明確目標並尋找資源支持，避免拖延與猶豫。',
            '權杖3': '權杖3 ——<br>事業與計劃開始擴展，等待收穫的成果。<br>正面(正位)： 遠景與擴展、耐心等待成果。<br>負面(逆位)： 過度自信或計劃失敗，無法擴展發展。<br>延伸： 專注長遠發展，保持耐心與彈性應對變化。',
            '權杖4': '權杖4 ——<br>基礎穩固與家庭幸福，慶祝成功的時刻。<br>正面(正位)： 家庭與社會關係穩定、成功與歡樂。<br>負面(逆位)： 表面的和諧、不穩定的根基。<br>延伸： 建議鞏固基礎與信任，確保穩定發展。',
            '權杖5': '權杖5 ——<br>挑戰與競爭，為目標努力奮鬥。<br>正面(正位)： 競爭與挑戰、積極應對困難。<br>負面(逆位)： 衝突與分裂、缺乏合作精神。<br>延伸： 提醒保持競爭精神，但避免無謂的爭鬥與分裂。',
            '權杖6': '權杖6 ——<br>勝利與表彰，得到眾人的肯定。<br>正面(正位)： 勝利與認可、成功的表彰與進步。<br>負面(逆位)： 自滿與驕傲、忽視他人的貢獻。<br>延伸： 鼓勵分享成功與團隊合作精神，保持謙遜態度。',
            '權杖7': '權杖7 ——<br>防衛與堅守立場，捍衛自己的信念。<br>正面(正位)： 自我防衛與堅持信念、保護成果。<br>負面(逆位)： 過度防禦、缺乏安全感與焦慮。<br>延伸： 建議確保自己立場穩固，同時開放接納建議與改進。',
            '權杖8': '權杖8 ——<br>快速變化與進展，迎接行動的機會。<br>正面(正位)： 快速進展與變化、溝通順暢。<br>負面(逆位)： 缺乏耐心、草率行動與混亂。<br>延伸： 提醒把握時機，但需保持冷靜與謹慎規劃。',
            '權杖9': '權杖9 ——<br>經歷過困難後的防衛心態，堅持信念但疲憊不堪。<br>正面(正位)： 堅持與保護成果、持續奮鬥。<br>負面(逆位)： 過度警戒、缺乏信任與疲憊不堪。<br>延伸： 鼓勵保持耐心與信念，但也要適時休息與調整。',
            '權杖10': '權杖10 ——<br>承擔責任與壓力，努力完成最後階段的目標。<br>正面(正位)： 承擔責任與完成目標、努力不懈。<br>負面(逆位)： 負擔過重、壓力過大與筋疲力竭。<br>延伸： 建議適度分擔責任，避免過度承擔導致身心疲憊。',
            '權杖侍者': '權杖侍者 ——<br>探索新機會、熱情與靈感的驅動。<br>正面(正位)： 創意與新點子、熱情探索機會。<br>負面(逆位)： 幼稚與衝動、缺乏耐性與穩重。<br>延伸： 鼓勵保持熱情，但需要更成熟的規劃與執行。',
            '權杖騎士': '權杖騎士 ——<br>果斷行動與冒險精神，主動追求目標。<br>正面(正位)： 冒險精神、積極行動與領導力。<br>負面(逆位)： 衝動與焦躁、缺乏計劃與方向。<br>延伸： 鼓勵勇於行動，但需謹慎規劃方向與步驟。',
            '權杖皇后': '權杖皇后 ——<br>富有創造力與魅力，具有領導風範與吸引力。<br>正面(正位)： 熱情與創造力、具有魅力的領袖。<br>負面(逆位)： 掌控欲過強、情緒化與固執己見。<br>延伸： 建議展現魅力與領導力，但要注意情緒管理與團隊合作。',
            '權杖國王': '權杖國王 ——<br>領導力與穩健的決策能力，成熟的控制與權威。<br>正面(正位)： 權威與遠見、穩重與果斷的領導者。<br>負面(逆位)： 專制與控制慾過強、固執與自大。<br>延伸： 提醒在發揮領導力時保持靈活與包容，以贏得信任與支持。',
            '寶劍1': '寶劍1 ——<br>真理與清晰的開始，突破性想法與溝通。<br>正面(正位)： 邏輯與洞察力，揭露真相並開啟新方向。<br>負面(逆位)： 冲突與爭論、言語傷害與誤解。<br>延伸： 鼓勵使用理性與誠實的溝通來解決問題。',
            '寶劍2': '寶劍2 ——<br>平衡與選擇，面對困難決策的時刻。<br>正面(正位)： 審慎考慮、保持冷靜與理智。<br>負面(逆位)： 遲疑不決、逃避選擇與被動態度。<br>延伸： 鼓勵尋求更多資訊，以做出明智的決定。',
            '寶劍3': '寶劍3 ——<br>痛苦與心碎，情感創傷與失落。<br>正面(正位)： 面對情感痛苦並開始療癒過程。<br>負面(逆位)： 悲傷難以釋懷、過度沉浸於痛苦。<br>延伸： 鼓勵接受傷痛，專注於自我療癒與成長。',
            '寶劍4': '寶劍4 ——<br>休息與沉思，暫時停止活動以恢復能量。<br>正面(正位)： 安靜與內省，適時休息與療癒。<br>負面(逆位)： 消極與逃避，缺乏行動與進展。<br>延伸： 鼓勵給自己空間與時間，恢復後再重新啟程。',
            '寶劍5': '寶劍5 ——<br>衝突與失敗，與他人爭執導致不滿。<br>正面(正位)： 學會讓步與自我反省，避免惡性競爭。<br>負面(逆位)： 自私與算計，缺乏團隊精神與合作意願。<br>延伸： 鼓勵放下自尊，尋找和平解決方案。',
            '寶劍6': '寶劍6 ——<br>過渡與移動，離開困難情況尋找更好的未來。<br>正面(正位)： 順應改變、脫離困境並前進。<br>負面(逆位)： 逃避問題、被動前行缺乏目標。<br>延伸： 鼓勵接受變化並計劃下一步行動。',
            '寶劍7': '寶劍7 ——<br>策略與謀略，靈活思考與秘密行動。<br>正面(正位)： 運用智慧與機智應對挑戰。<br>負面(逆位)： 欺騙與隱瞞、不誠實的行為導致後果。<br>延伸： 提醒誠信與責任，避免不正當手段。',
            '寶劍8': '寶劍8 ——<br>受困與限制，自我懷疑與恐懼束縛。<br>正面(正位)： 尋求內心力量突破困境。<br>負面(逆位)： 無助與絕望，感到被困住而無法行動。<br>延伸： 鼓勵換個角度看待問題，尋找解決方法。',
            '寶劍9': '寶劍9 ——<br>焦慮與失眠，過度擔憂與負面情緒纏繞。<br>正面(正位)： 面對恐懼並開始尋求解決之道。<br>負面(逆位)： 過度焦慮、沉溺於負面思想難以釋放。<br>延伸： 鼓勵練習自我關懷與情感管理，尋求支持。',
            '寶劍10': '寶劍10 ——<br>結束與痛苦的高潮，接受現狀並準備重生。<br>正面(正位)： 放下過去、結束一段艱難的歷程。<br>負面(逆位)： 完全崩潰、絕望與失去希望。<br>延伸： 鼓勵接受結束並準備迎接新的開始。',
            '寶劍侍者': '寶劍侍者 ——<br>警覺與好奇心，探索資訊與尋找答案。<br>正面(正位)： 智慧與分析能力，快速學習與理解事物。<br>負面(逆位)： 過度懷疑、偷窺與散布流言。<br>延伸： 鼓勵培養觀察力並保持開放心態，避免過度批判。',
            '寶劍騎士': '寶劍騎士 ——<br>果斷行動與快速反應，追求真相與目標。<br>正面(正位)： 勇敢與積極，毫不猶豫地追求理想。<br>負面(逆位)： 衝動與輕率，忽略風險與後果。<br>延伸： 提醒保持冷靜與理智，以穩健態度行動。',
            '寶劍皇后': '寶劍皇后 ——<br>智慧與決斷力，善於分析問題並給出建議。<br>正面(正位)： 思維敏銳、具邏輯性且公正無私。<br>負面(逆位)： 冷酷與情感疏離，過度批評與挑剔。<br>延伸： 鼓勵溝通時保持理性，但要兼顧情感平衡。',
            '寶劍國王': '寶劍國王 ——<br>權威與邏輯，具備統率與控制局勢的能力。<br>正面(正位)： 理性與冷靜的領導者，戰略計劃執行力強。<br>負面(逆位)： 專制與過度控制，忽視他人感受。<br>延伸： 建議領導時兼顧理性與情感，營造支持性的環境。',
            '錢幣1': '錢幣1 ——<br>財富與穩定的開始，物質基礎與機會浮現。<br>正面(正位)： 實際行動與新機遇，財務穩定與成長。<br>負面(逆位)： 固守現狀、錯失機會與過度物質主義。<br>延伸： 鼓勵理財規劃與腳踏實地行動，為未來奠定基礎。',
            '錢幣2': '錢幣2 ——<br>平衡與管理資源，靈活應對多重任務。<br>正面(正位)： 適應變化、靈活調整與資源管理得宜。<br>負面(逆位)： 分身乏術、壓力過大與優先順序混亂。<br>延伸： 建議審視優先順序並有效分配資源，避免過度負荷。',
            '錢幣3': '錢幣3 ——<br>合作與技術發展，展現技能與成果。<br>正面(正位)： 團隊合作、專業技能與持續進步。<br>負面(逆位)： 缺乏協作、技術不足與未能展現能力。<br>延伸： 鼓勵團隊合作與提升專業技能，持續學習與進步。',
            '錢幣4': '錢幣4 ——<br>守財與保守，重視安全感與物質保障。<br>正面(正位)： 財務穩定、節約與安全感。<br>負面(逆位)： 過度保守、吝嗇與對變化的抗拒。<br>延伸： 提醒適度分享與投資，避免因保守而錯失機會。',
            '錢幣5': '錢幣5 ——<br>困境與損失，財務壓力與不穩定狀況。<br>正面(正位)： 尋求幫助、學習適應困難與堅持不懈。<br>負面(逆位)： 貧困、孤立與缺乏安全感。<br>延伸： 鼓勵主動尋找支持，積極改善現狀並信任未來。',
            '錢幣6': '錢幣6 ——<br>施予與接受，財務平衡與善行回報。<br>正面(正位)： 慷慨與支持、共享資源與慈善行為。<br>負面(逆位)： 過度依賴、利用與不公平的付出與回報。<br>延伸： 建議在給予與接受間保持平衡，注意互惠關係。',
            '錢幣7': '錢幣7 ——<br>耐心與長期投資，評估成果與規劃未來。<br>正面(正位)： 努力成果逐漸顯現，耐心等待成長與回報。<br>負面(逆位)： 缺乏耐性、對未來過度焦慮或不滿現狀。<br>延伸： 鼓勵長遠規劃與持續努力，不要急於求成。',
            '錢幣8': '錢幣8 ——<br>勤奮與技能提升，專注工作與精益求精。<br>正面(正位)： 致力於技術提升與專業發展，成果穩步增長。<br>負面(逆位)： 單調重複的工作、忽視創意與發展。<br>延伸： 鼓勵培養專業技能與自我提升，同時保持創意與熱情。',
            '錢幣9': '錢幣9 ——<br>成就與獨立，物質與精神的滿足。<br>正面(正位)： 財務穩定、自信與享受生活成果。<br>負面(逆位)： 孤立與物質享樂過度，缺乏深層連結。<br>延伸： 提醒珍惜成果並分享快樂，避免過於物質導向。',
            '錢幣10': '錢幣10 ——<br>家庭財富與遺產，長期安全與穩固基礎。<br>正面(正位)： 財富累積、家庭幸福與世代傳承。<br>負面(逆位)： 過度依賴家庭資源、缺乏創新與自我發展。<br>延伸： 鼓勵珍惜家庭支持，建立穩固財務與人際關係基礎。',
            '錢幣侍者': '錢幣侍者 ——<br>學習與探索新機會，實現財務或技能成長。<br>正面(正位)： 勤奮與細心學習、創造新的機會與成就。<br>負面(逆位)： 過度謹慎、缺乏自信與冒險精神。<br>延伸： 鼓勵主動尋求知識與技能，為長遠發展奠定基礎。',
            '錢幣騎士': '錢幣騎士 ——<br>穩健與耐心，追求實際成果與長期穩定。<br>正面(正位)： 勤奮工作、腳踏實地與謹慎行動。<br>負面(逆位)： 過於保守、缺乏彈性與創新。<br>延伸： 建議保持穩健與堅持，但適時接受變革與挑戰。',
            '錢幣皇后': '錢幣皇后 ——<br>豐饒與支持，代表母性與物質富足。<br>正面(正位)： 關懷與創造力、保護與培養成長。<br>負面(逆位)： 過度控制、固守舊有模式與依賴安全感。<br>延伸： 鼓勵展現包容心與靈活性，同時確保內心與物質的平衡。',
            '錢幣國王': '錢幣國王 ——<br>穩固與成功，擁有財務管理與領導力。<br>正面(正位)： 成熟與穩重、財務管理與決策能力強。<br>負面(逆位)： 過於物質主義、固執與缺乏感情連結。<br>延伸： 建議發揮領導力與遠見，但保持謙遜與開放態度。',
            '聖杯1': '聖杯1 ——<br>情感與靈性的新開始，愛與希望的象徵。<br>正面(正位)： 新感情的開始、愛與靈性成長。<br>負面(逆位)： 情感過度依賴、缺乏內心滿足。<br>延伸： 建議敞開心扉迎接新機遇，同時保持情感平衡與自愛。',
            '聖杯2': '聖杯2 ——<br>關係的連結與和諧，感情互動與合作。<br>正面(正位)： 關係和諧、合作與愛情聯結。<br>負面(逆位)： 關係失衡、不信任與衝突。<br>延伸： 強調溝通與理解的重要性，尋找雙方共同成長的方向。',
            '聖杯3': '聖杯3 ——<br>慶祝與友情，分享喜悅與成就的時刻。<br>正面(正位)： 慶祝與友誼、歡樂時刻。<br>負面(逆位)： 流於享樂、情感泛濫或三角關係。<br>延伸： 鼓勵享受快樂，但需注意節制與人際界限的掌控。',
            '聖杯4': '聖杯4 ——<br>內省與思考，對生活滿足度的反思。<br>正面(正位)： 反思與內在探索。<br>負面(逆位)： 冷漠、拒絕新機會與機會錯失。<br>延伸： 提醒關注眼前機會，不要被消極情緒困住。',
            '聖杯5': '聖杯5 ——<br>悲傷與失落，學習接受過去的遺憾。<br>正面(正位)： 情感釋放、學會接受失去。<br>負面(逆位)： 悲傷與失落、過度自責。<br>延伸： 鼓勵從失敗中學習，將注意力轉向新的希望與可能性。',
            '聖杯6': '聖杯6 ——<br>回憶與懷舊，童年的記憶與簡單的幸福。<br>正面(正位)： 回憶與懷舊、童年回憶的溫暖。<br>負面(逆位)： 過度沉湎於過去、拒絕成長。<br>延伸： 平衡過去與現在的情感，利用記憶激勵前行。',
            '聖杯7': '聖杯7 ——<br>幻想與選擇，多重可能性與困惑的情境。<br>正面(正位)： 想像力與夢想、選擇的機會。<br>負面(逆位)： 幻想過度、優柔寡斷與誘惑。<br>延伸： 提醒現實評估選擇，避免被表象所迷惑。',
            '聖杯8': '聖杯8 ——<br>放下與前進，追求更高目標與內心滿足。<br>正面(正位)： 放下與前進、追求更高目標。<br>負面(逆位)： 逃避現實、不滿現況卻不願行動。<br>延伸： 建議勇敢離開不再適合的環境，尋找新的目標與意義。',
            '聖杯9': '聖杯9 ——<br>滿足與成就，夢想實現的時刻。<br>正面(正位)： 情感滿足與願望實現。<br>負面(逆位)： 自滿與驕傲、情感上的空虛。<br>延伸： 鼓勵珍惜當下滿足感，同時避免過度自信與放縱。',
            '聖杯10': '聖杯10 ——<br>幸福與和諧，家庭與關係的圓滿。<br>正面(正位)： 家庭幸福與圓滿、情感和諧。<br>負面(逆位)： 表面和諧、隱藏的內心不安。<br>延伸： 尋求真實的幸福，確保內外一致的和諧關係。',
            '聖杯侍者': '聖杯侍者 ——<br>情感探索與創意靈感，夢想的萌芽階段。<br>正面(正位)： 情感的探索、靈感與創意。<br>負面(逆位)： 情緒幼稚、逃避現實與自我沉迷。<br>延伸： 鼓勵勇敢表達情感，但需要穩重與成熟的情緒管理。',
            '聖杯騎士': '聖杯騎士 ——<br>浪漫與追求愛情，理想與夢想的行動者。<br>正面(正位)： 浪漫與追求愛情、理想主義者。<br>負面(逆位)： 情緒不穩定、幻想與脫離現實。<br>延伸： 鼓勵追求夢想，但同時注意保持實際與穩健。',
            '聖杯皇后': '聖杯皇后 ——<br>包容與溫柔，情感的支持與養育。<br>正面(正位)： 包容與溫柔、情感的支持與養育。<br>負面(逆位)： 過度敏感、情感操控與依賴。<br>延伸： 建議展現愛心與同理心，同時注意保護自己的情感界限。',
            '聖杯國王': '聖杯國王 ——<br>情感成熟與穩重，值得信賴的顧問與領導者。<br>正面(正位)： 情感成熟與穩重、值得信賴的顧問。<br>負面(逆位)： 情感壓抑、控制情緒以掩蓋不安。<br>延伸： 鼓勵在情感中保持理性與穩健，同時展現關懷與支持。'
        };
            return descriptions[item] || '無詳細解說';
    }
    // 卡圖設定
    const tarotImageMap = {
        '愚者': 'img/t0.png',
        '魔術師': 'img/t1.png',
        '女祭司': 'img/t2.png',
        '皇后': 'img/t3.png',
        '皇帝': 'img/t4.png',
        '教皇': 'img/t5.png',
        '戀人': 'img/t6.png',
        '戰車': 'img/t7.png',
        '正義': 'img/t8.png',
        '隱者': 'img/t9.png',
        '命運之輪': 'img/t10.png',
        '力量': 'img/t11.png',
        '倒吊人': 'img/t12.png',
        '死神': 'img/t13.png',
        '節制': 'img/t14.png',
        '惡魔': 'img/t15.png',
        '天雷': 'img/t16.png',
        '星星': 'img/t17.png',
        '月亮': 'img/t18.png',
        '太陽': 'img/t19.png',
        '審判': 'img/t20.png',
        '世界': 'img/t21.png',
        '小鬼': 'img/joker_small.png',
        '鬼王': 'img/joker_big.png',
        '大吉': 'img/3g.png',
        '中吉': 'img/2g.png',
        '小吉': 'img/1g.png',
        '末吉': 'img/0g.png',
        '凶': 'img/1s.png',
        '大凶': 'img/2s.png',
            // 聖杯 (W)
    '聖杯1': 'img/W1.png',
    '聖杯2': 'img/W2.png',
    '聖杯3': 'img/W3.png',
    '聖杯4': 'img/W4.png',
    '聖杯5': 'img/W5.png',
    '聖杯6': 'img/W6.png',
    '聖杯7': 'img/W7.png',
    '聖杯8': 'img/W8.png',
    '聖杯9': 'img/W9.png',
    '聖杯10': 'img/W10.png',
    '聖杯侍者': 'img/W11.png',
    '聖杯騎士': 'img/W12.png',
    '聖杯皇后': 'img/W13.png',
    '聖杯國王': 'img/W14.png',

    // 權杖 (F)
    '權杖1': 'img/F1.png',
    '權杖2': 'img/F2.png',
    '權杖3': 'img/F3.png',
    '權杖4': 'img/F4.png',
    '權杖5': 'img/F5.png',
    '權杖6': 'img/F6.png',
    '權杖7': 'img/F7.png',
    '權杖8': 'img/F8.png',
    '權杖9': 'img/F9.png',
    '權杖10': 'img/F10.png',
    '權杖侍者': 'img/F11.png',
    '權杖騎士': 'img/F12.png',
    '權杖皇后': 'img/F13.png',
    '權杖國王': 'img/F14.png',

    // 寶劍 (S)
    '寶劍1': 'img/S1.png',
    '寶劍2': 'img/S2.png',
    '寶劍3': 'img/S3.png',
    '寶劍4': 'img/S4.png',
    '寶劍5': 'img/S5.png',
    '寶劍6': 'img/S6.png',
    '寶劍7': 'img/S7.png',
    '寶劍8': 'img/S8.png',
    '寶劍9': 'img/S9.png',
    '寶劍10': 'img/S10.png',
    '寶劍侍者': 'img/S11.png',
    '寶劍騎士': 'img/S12.png',
    '寶劍皇后': 'img/S13.png',
    '寶劍國王': 'img/S14.png',

    // 錢幣 (C)
    '錢幣1': 'img/C1.png',
    '錢幣2': 'img/C2.png',
    '錢幣3': 'img/C3.png',
    '錢幣4': 'img/C4.png',
    '錢幣5': 'img/C5.png',
    '錢幣6': 'img/C6.png',
    '錢幣7': 'img/C7.png',
    '錢幣8': 'img/C8.png',
    '錢幣9': 'img/C9.png',
    '錢幣10': 'img/C10.png',
    '錢幣侍者': 'img/C11.png',
    '錢幣騎士': 'img/C12.png',
    '錢幣皇后': 'img/C13.png',
    '錢幣國王': 'img/C14.png'
        };
    // 縮寫替換符號
    const suitSymbols = {
        's': '♠️', 
        'h': '♥️', 
        'c': '♣️', 
        'd': '♦️'  
    };
    // 縮寫替換符號設定
    function formatCardName(name) {
        const match = name.match(/^(\d+|[AKQJ])([shcd])$/); 
        if (match) {
            const value = match[1]; 
            const suit = match[2];
            return `${value}${suitSymbols[suit]}`;
        }
        return name; 
    }

    // 撲克牌面造型設定
    function generateCardContent(item) {
        if (tarotImageMap[item]) {
            return `
                <div style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; 
                            background-image: url('${tarotImageMap[item]}'); 
                            background-size: cover; 
                            background-position: center; 
                            border-radius: 4px;">
                </div>`;
        }       
        if (/^10[shcd]$/.test(item)) { 
            const suit = item.charAt(2); 
            const symbol = suitSymbols[suit]; 
            return `
                <div style="position: relative; width: 100%; height: 100%; padding: 5px;">
                    <div style="position: absolute; top: 5px; left: 5px; font-weight: bold;">
                        <span style="font-size: 14px; writing-mode: horizontal-tb;">10</span>
                        <span style="font-size: 16px; writing-mode: vertical-rl;">${symbol}</span>
                    </div>
                    <div style="position: absolute; bottom: 5px; right: 5px; font-weight: bold; transform: rotate(180deg);">
                        <span style="font-size: 14px; writing-mode: horizontal-tb;">10</span>
                        <span style="font-size: 16px; writing-mode: vertical-rl;">${symbol}</span>
                    </div>
                </div>`;
        }
        if (/[♥️♠️♣️♦️]/.test(item)) {
            const symbol = item.match(/[♥️♠️♣️♦️]/)[0];
            const number = item.replace(/[♥️♠️♣️♦️]/, '');
            const displayText = (number === '10') 
                ? `<span style="display: inline-block; font-size: 12px; writing-mode: horizontal-tb !important;">${number}</span>
                   <span style="display: inline-block; font-size: 16px; writing-mode: vertical-rl;">${symbol}</span>`
                : `<span style="writing-mode: vertical-rl;">${item}</span>`; 
            return `
                <div style="position: relative; width: 100%; height: 100%; padding: 5px;">
                    <div style="position: absolute; top: 5px; left: 5px; font-size: 16px; font-weight: bold;">
                        ${displayText}
                    </div>
                    <div style="position: absolute; bottom: 5px; right: 5px; font-size: 16px; font-weight: bold; transform: rotate(180deg);">
                        ${displayText}
                    </div>
               </div>`;
        }
        return `<div style="text-align: center; font-size: 16px; font-weight: bold;">${item}</div>`;
    }
        // 點名設定
        callBtn.addEventListener('click', () => {
            clickSound.currentTime = 0; // 重置播放位置
            clickSound.play().catch(error => console.warn('按鈕音效失敗:', error));
            const items = inputArea.value.trim().split('\n').filter(Boolean);
            if (items.length < 1) {
                alert('請至少輸入一個項目進行點名！');
                return;
            }
            inputArea.style.display = 'none';
            exampleContainer.style.display = 'none'; 
            cardContainer.style.display = 'flex';
            cardContainer.innerHTML = '';
            const colorMap = {
                '#728ee2': ["經國","大竹","南崁","南昌","中壢","環東","桃鶯","正光","八德","龍潭","楊梅","龜山"],
                '#9bc490': ["竹北"],
                '#d4b280': ["公益","福科","崇德"],
                '#b48cc8': ["三峽","板橋","新泰","龍安","西門","永和"]
            };

            items.forEach(item => {
                const formattedItem = formatCardName(item);
                const card = document.createElement('div');
                card.className = 'card hoverable';
                card.textContent = formattedItem; 
                card.style.height = '28px'; 
                card.style.lineHeight = '28px';
                card.style.fontSize = '16px';
                card.style.textAlign = 'center';
                card.style.backgroundColor = '#e6c35c';
                card.style.color = '#000';
                card.style.fontWeight = 'bold';
                card.style.borderRadius = '4px';
                card.style.boxShadow = '0px 3px 5px rgba(0, 0, 0, 0.6)';
                if (item.length >= 4) { 
                    card.style.fontSize = '12px'; 
                }
                for (const [color, keywords] of Object.entries(colorMap)) {
                    if (keywords.includes(item)) {
                        card.style.backgroundColor = color;
                        break;
                    }
                }
                card.addEventListener('click', () => {
                    card.classList.toggle('dimmed');
                    card.classList.remove('hoverable'); 
                    setTimeout(() => card.classList.add('hoverable'), 10); 
                });
                cardContainer.appendChild(card);
            });
        });

        clearBtn.addEventListener('click', () => {
            cardContainer.classList.remove('tarot-mode');
            clickSound.currentTime = 0; // 重置播放位置
            clickSound.play().catch(error => console.warn('按鈕音效失敗:', error));
            inputArea.value = '';
            cardContainer.innerHTML = '';
            inputArea.style.display = 'block';
            exampleContainer.style.display = 'flex';
            exampleOptions.style.visibility = 'flex';
            cardContainer.style.display = 'none';
            descriptionBox.style.display = 'none';
        });

        // 時間顯示函數
        function updateTime() {
            const now = new Date();
            const year = now.getFullYear(); // 年
            const month = String(now.getMonth() + 1).padStart(2, '0'); // 月 (補0)
            const day = String(now.getDate()).padStart(2, '0'); // 日 (補0)
            const hours = String(now.getHours()).padStart(2, '0'); // 時
            const minutes = String(now.getMinutes()).padStart(2, '0'); // 分
            const seconds = String(now.getSeconds()).padStart(2, '0'); // 秒

            document.getElementById('time-display').textContent =
                `${year}/${month}/${day} ${hours}:${minutes}:${seconds}`;
        }
        // 每秒更新一次時間
        setInterval(updateTime, 1000);
        updateTime();
        
    // 音效與 BGM 控制
const bgmAudio = new Audio('https://crisvictor.github.io/dccool/m/lost-in-dreams.mp3');
bgmAudio.loop = true; // 設置 BGM 循環播放
bgmAudio.volume = 0.5; // 預設音量

const volumeSlider = document.getElementById('volume-slider');
const bgmButton = document.getElementById('bgm-button');
const muteIcon = document.createElement('span'); 
muteIcon.id = 'mute-icon';
muteIcon.textContent = '🔇';
muteIcon.style.display = 'none';
volumeSlider.parentElement.insertBefore(muteIcon, volumeSlider); 

function updateSliderFill() {
    const value = (volumeSlider.value - volumeSlider.min) / 
                  (volumeSlider.max - volumeSlider.min) * 100;
    volumeSlider.style.background = `linear-gradient(to right, 
        rgba(49, 97, 197, 0.8) ${value}%, 
        rgba(19, 67, 167, 0.2) ${value}%)`;
}

volumeSlider.addEventListener('input', (event) => {
    const volume = parseFloat(event.target.value);
    bgmAudio.volume = volume;
    shuffleSound.volume = volume; 
    flipSound.volume = volume;   
    scoreSound.volume = volume;  
    clickSound.volume = volume;  

    updateSliderFill();

    if (volume === 0) {
        muteIcon.style.display = 'inline'; 
        bgmButton.style.backgroundColor = 'rgba(209, 111, 111, 0.3)';
    } else {
        muteIcon.style.display = 'none'; 
        bgmButton.style.backgroundColor = 'rgba(79, 101, 121, 0.3)';
    }
});

let isPlaying = false;
bgmButton.addEventListener('click', () => {
    if (isPlaying) {
        bgmAudio.pause();
        bgmButton.textContent = '♫'; 
    } else {
        bgmAudio.play();
        bgmButton.textContent = '❚❚'; 
    }
    isPlaying = !isPlaying;
});

shuffleSound.volume = 0.5; 
flipSound.volume = 0.5;  
scoreSound.volume = 0.5;
clickSound.volume = 0.5;

updateSliderFill();
    </script>
</body>
</html>
